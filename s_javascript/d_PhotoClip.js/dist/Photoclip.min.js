/*!
 * PhotoClip - 一款手势驱动的裁图插件
 * @version v3.4.6
 * @author baijunjie
 * @license MIT
 * 
 * git - https://github.com/baijunjie/PhotoClip.js.git
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("hammerjs"),require("iscroll/build/iscroll-zoom"),require("lrz")):"function"==typeof define&&define.amd?define(["hammerjs","iscroll","lrz"],e):"object"==typeof exports?exports.PhotoClip=e(require("hammerjs"),require("iscroll/build/iscroll-zoom"),require("lrz")):t.PhotoClip=e(t.Hammer,t.IScroll,t.lrz)}(window,function(i,o,r){return function(i){var o={};function r(t){if(o[t])return o[t].exports;var e=o[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}return r.m=i,r.c=o,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(i,o,function(t){return e[t]}.bind(null,o));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=4)}([function(t,e,i){var o,r,a;r=[],void 0===(a="function"==typeof(o=function(){"use strict";t.exports=function(t){return"[object Array]"===Object.prototype.toString.call(t)}})?o.apply(e,r):o)||(t.exports=a)},function(t,e,i){var o,r,a;r=[],void 0===(a="function"==typeof(o=function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}t.exports=function(t){return"object"===e(t)}})?o.apply(e,r):o)||(t.exports=a)},function(t,e,i){var o,r,a;r=[],void 0===(a="function"==typeof(o=function(){"use strict";t.exports=function(t){return"number"==typeof t}})?o.apply(e,r):o)||(t.exports=a)},function(t,e,i){var o,r,a;r=[],void 0===(a="function"==typeof(o=function(){"use strict";function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var f={};t.exports=function(t,e,i){"object"!==c(t)&&(t=[]),void 0===t.length&&(t=[t]);for(var o,r=[],a=[],n=0;o=t[n++];)for(;o instanceof HTMLElement;){var s=o.nodeName;if(!o.getClientRects().length){r.push(o),a.push(o.style.display);var l=f[s];if(!l){var u=document.createElement(s);document.body.appendChild(u),l=window.getComputedStyle(u).display,u.parentNode.removeChild(u),"none"===l&&(l="block"),f[s]=l}o.style.display=l}if("BODY"===s)break;o=o.parentNode}"function"==typeof e&&e.call(i||this);for(var h=r.length;h--;)r.pop().style.display=a.pop()}})?o.apply(e,r):o)||(t.exports=a)},function(H,E,t){var e,i,o;i=[E,t(5),t(6),t(7),t(8),t(9),t(10),t(2),t(0),t(14),t(15),t(16),t(3),t(17),t(18),t(19),t(20),t(22)],void 0===(o="function"==typeof(e=function(t,s,r,a,n,l,u,L,h,c,f,p,_,e,b,d,y,m){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,s=i(s),r=i(r),a=i(a),n=i(n),l=i(l),u=i(u),L=i(L),h=i(h),c=i(c),f=i(f),p=i(p),_=i(_),e=i(e),b=i(b),d=i(d),y=i(y),m=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,i):{};o.get||o.set?Object.defineProperty(e,i,o):e[i]=t[i]}return e.default=t,e}(m);var S=!!navigator.userAgent.match(/mobile/i),o=!!navigator.userAgent.match(/android/i),x=(0,e.default)("transition"),z=(0,e.default)("transform"),$=function(){},k={size:[100,100],adaptive:"",outputSize:[0,0],outputType:"jpg",outputQuality:.8,maxZoom:1,rotateFree:!o,view:"",file:"",ok:"",img:"",loadStart:$,loadComplete:$,loadError:$,done:$,fail:$,lrzOption:{width:o?1e3:void 0,height:o?1e3:void 0,quality:.7},style:{maskColor:"rgba(0,0,0,.5)",maskBorder:"2px dashed #ddd",jpgFillColor:"#fff"},errorMsg:{noSupport:"您的浏览器版本过于陈旧，无法支持裁图功能，请更换新的浏览器！",imgError:"不支持该图片格式，请选择常规格式的图片文件！",imgHandleError:"图片处理失败！请更换其它图片尝试。",imgLoadError:"图片读取失败！请更换其它图片尝试。",noImg:"没有可裁剪的图片！",clipError:"截图失败！当前图片源文件可能存在跨域问题，请确保图片与应用同源。如果您是在本地环境下执行本程序，请更换至服务器环境。"}},w=function(){function i(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(t=(0,y.default)(t))&&t.length&&(this._$container=t[0],this._options=(0,u.default)(!0,{},k,e),void 0===z&&this._options.errorMsg.noSupport&&alert(this._options.errorMsg.noSupport),this._init())}return t=i,(e=[{key:"_init",value:function(){var e=this,t=this._options;(0,L.default)(t.size)?t.size=[t.size,t.size]:(0,h.default)(t.size)?((!(0,L.default)(t.size[0])||t.size[0]<=0)&&(t.size[0]=k.size[0]),(!(0,L.default)(t.size[1])||t.size[1]<=0)&&(t.size[1]=k.size[1])):t.size=(0,u.default)({},k.size),(0,L.default)(t.outputSize)?t.outputSize=[t.outputSize,0]:(0,h.default)(t.outputSize)?((!(0,L.default)(t.outputSize[0])||t.outputSize[0]<0)&&(t.outputSize[0]=k.outputSize[0]),(!(0,L.default)(t.outputSize[1])||t.outputSize[1]<0)&&(t.outputSize[1]=k.outputSize[1])):t.outputSize=(0,u.default)({},k.outputSize),"jpg"===t.outputType?t.outputType="image/jpeg":t.outputType="image/png",(0,h.default)(t.adaptive)&&(this._widthIsPercent=!(!t.adaptive[0]||!(0,c.default)(t.adaptive[0]))&&t.adaptive[0],this._heightIsPercent=!(!t.adaptive[1]||!(0,c.default)(t.adaptive[1]))&&t.adaptive[1]),this._outputWidth=t.outputSize[0],this._outputHeight=t.outputSize[1],this._canvas=document.createElement("canvas"),this._iScroll=null,this._hammerManager=null,this._clipWidth=0,this._clipHeight=0,this._clipSizeRatio=1,this._$img=null,this._imgLoaded=!1,this._containerWidth=0,this._containerHeight=0,this._viewList=null,this._fileList=null,this._okList=null,this._$mask=null,this._$mask_left=null,this._$mask_right=null,this._$mask_right=null,this._$mask_bottom=null,this._$clip_frame=null,this._$clipLayer=null,this._$moveLayer=null,this._$rotateLayer=null,this._moveLayerWidth=0,this._moveLayerHeight=0,this._moveLayerPaddingLeft=0,this._moveLayerPaddingTop=0,this._atRotation=!1,this._rotateLayerWidth=0,this._rotateLayerHeight=0,this._rotateLayerX=0,this._rotateLayerY=0,this._rotateLayerOriginX=0,this._rotateLayerOriginY=0,(this._curAngle=0,n.default)(this,"_resetScroll","_rotateCW90","_fileOnChangeHandle","_clipImg","_resize","size","load","clear","rotate","scale","clip","destroy"),this._initElements(),this._initScroll(),this._initRotationEvent(),this._initFile(),this._resize(),window.addEventListener("resize",this._resize),(this._okList=(0,y.default)(t.ok))&&this._okList.forEach(function(t){t.addEventListener("click",e._clipImg)}),this._options.img&&this._lrzHandle(this._options.img)}},{key:"_initElements",value:function(){var t=this._$container,e=t.style,i={};i["user-select"]=e["user-select"],i.overflow=e.overflow,i.position=e.position,this._containerOriginStyle=i,(0,b.default)(t,{"user-select":"none",overflow:"hidden"}),"static"===(0,b.default)(t,"position")&&(0,b.default)(t,"position","relative"),this._$clipLayer=(0,f.default)(t,"photo-clip-layer",{position:"absolute",left:"50%",top:"50%"}),this._$moveLayer=(0,f.default)(this._$clipLayer,"photo-clip-move-layer"),this._$rotateLayer=(0,f.default)(this._$moveLayer,"photo-clip-rotate-layer");var o=this._$mask=(0,f.default)(t,"photo-clip-mask",{position:"absolute",left:0,top:0,width:"100%",height:"100%","pointer-events":"none"}),r=this._options,a=r.style.maskColor,n=r.style.maskBorder;if(this._$mask_left=(0,f.default)(o,"photo-clip-mask-left",{position:"absolute",left:0,right:"50%",top:"50%",bottom:"50%",width:"auto","background-color":a}),this._$mask_right=(0,f.default)(o,"photo-clip-mask-right",{position:"absolute",left:"50%",right:0,top:"50%",bottom:"50%","background-color":a}),this._$mask_top=(0,f.default)(o,"photo-clip-mask-top",{position:"absolute",left:0,right:0,top:0,bottom:"50%","background-color":a}),this._$mask_bottom=(0,f.default)(o,"photo-clip-mask-bottom",{position:"absolute",left:0,right:0,top:"50%",bottom:0,"background-color":a}),this._$clip_frame=(0,f.default)(o,"photo-clip-area",{border:n,position:"absolute",left:"50%",top:"50%"}),this._viewList=(0,y.default)(r.view),this._viewList){var s=[];this._viewList.forEach(function(t,e){var i=t.style,o={};o["background-repeat"]=i["background-repeat"],o["background-position"]=i["background-position"],o["background-size"]=i["background-size"],s[e]=o,(0,b.default)(t,{"background-repeat":"no-repeat","background-position":"center","background-size":"contain"})}),this._viewOriginStyleList=s}}},{key:"_initScroll",value:function(){var t=this;this._iScroll=new r.default(this._$clipLayer,{zoom:!0,scrollX:!0,scrollY:!0,freeScroll:!0,mouseWheel:!0,disablePointer:!0,disableTouch:!1,disableMouse:!1,wheelAction:"zoom",bounceTime:300}),this._iScroll.on("zoomEnd",function(){t._calcScale(),t._resizeMoveLayer(),t._refreshScroll()})}},{key:"_resetScroll",value:function(){var t=this._iScroll;this._calcScale();var e=t.scale=t.options.startZoom;this._resizeMoveLayer(),this._rotateLayerX=0,this._rotateLayerY=0,this._curAngle=0,M(this._$rotateLayer,this._rotateLayerX+this._moveLayerPaddingLeft,this._rotateLayerY+this._moveLayerPaddingTop,this._curAngle),t.scrollTo(.5*(this._clipWidth-this._moveLayerWidth*e),.5*(this._clipHeight-this._moveLayerHeight*e)),this._refreshScroll()}},{key:"_refreshScroll",value:function(t){t=t||0;var e=this._iScroll,i=e.scale,o=e.options,r=Math.max(o.zoomMin,Math.min(o.zoomMax,i));r!==i&&e.zoom(r,void 0,void 0,t),e.refresh(t)}},{key:"_resizeMoveLayer",value:function(){var t=this._iScroll,e=t.options,i=Math.max(e.zoomMin,Math.min(e.zoomMax,t.scale)),o=this._rotateLayerWidth,r=this._rotateLayerHeight,a=this._clipWidth/i,n=this._clipHeight/i,s=!1;if(o<a){s=!0;var l=a-o;o+=2*l,t.x+=(this._moveLayerPaddingLeft-l)*i,this._moveLayerPaddingLeft=l}else this._moveLayerPaddingLeft=0;if(r<n){s=!0;var u=n-r;r+=2*u,t.y+=(this._moveLayerPaddingTop-u)*i,this._moveLayerPaddingTop=u}else this._moveLayerPaddingTop=0;s&&(M(this._$rotateLayer,this._rotateLayerX+this._moveLayerPaddingLeft,this._rotateLayerY+this._moveLayerPaddingTop,this._curAngle),t.scrollTo(t.x,t.y)),this._moveLayerWidth===o&&this._moveLayerHeight===r||(this._moveLayerWidth=o,this._moveLayerHeight=r,(0,b.default)(this._$moveLayer,{width:o,height:r}),this._$clipLayer.appendChild(this._$moveLayer))}},{key:"_calcScale",value:function(){var t=this._iScroll,e=t.options,i=this._rotateLayerWidth,o=this._rotateLayerHeight,r=this._options.maxZoom;e.startZoom=i&&o?(e.zoomMin=Math.min(1,m.getScale(this._clipWidth,this._clipHeight,i,o)),e.zoomMax=r,Math.min(r,m.getScale(this._containerWidth,this._containerHeight,i,o))):(e.zoomMin=1,e.zoomMax=1)}},{key:"_initRotationEvent",value:function(){var i=this;if(S){this._hammerManager=new s.default.Manager(this._$moveLayer),this._hammerManager.add(new s.default.Rotate);var o,e,r,a=this._options.rotateFree,n=this._iScroll.options.bounceTime;this._hammerManager.on("rotatestart",function(t){i._atRotation||(o=!0,a?(e=(t.rotation-i._curAngle)%360,i._rotateLayerRotateReady(t.center)):e=t.rotation)}),this._hammerManager.on("rotatemove",function(t){o&&(r=t.rotation-e,a&&i._rotateLayerRotate(r))}),this._hammerManager.on("rotateend rotatecancel",function(t){if(o){if(o=!1,!a)return 180<(r%=360)?r-=360:r<-180&&(r+=360),void(30<r?i._rotateBy(90,n,t.center):r<-30&&i._rotateBy(-90,n,t.center));var e=r%360;e<0&&(e+=360),e<10?r+=-e:80<e&&e<100?r+=90-e:170<e&&e<190?r+=180-e:260<e&&e<280?r+=270-e:350<e&&(r+=360-e),i._rotateLayerRotateFinish(r,n)}})}else this._$moveLayer.addEventListener("dblclick",this._rotateCW90)}},{key:"_rotateCW90",value:function(t){this._rotateBy(90,this._iScroll.options.bounceTime,{x:t.clientX,y:t.clientY})}},{key:"_rotateBy",value:function(t,e,i){this._rotateTo(this._curAngle+t,e,i)}},{key:"_rotateTo",value:function(t,e,i){this._atRotation||(this._rotateLayerRotateReady(i),this._rotateLayerRotateFinish(t,e))}},{key:"_rotateLayerRotateReady",value:function(t){var e,i=this._iScroll.scale;(e=t?m.globalToLoacl(this._$moveLayer,t.x,t.y):m.loaclToLoacl(this._$moveLayer,this._$clipLayer,.5*this._clipWidth,.5*this._clipHeight)).x/=i,e.y/=i;var o={x:e.x-(this._rotateLayerX+this._moveLayerPaddingLeft),y:e.y-(this._rotateLayerY+this._moveLayerPaddingTop)},r=m.pointRotate(o,-this._curAngle);this._rotateLayerOriginX=r.x,this._rotateLayerOriginY=r.y;var a=this._$rotateLayer.getBoundingClientRect();P(this._$rotateLayer,this._rotateLayerOriginX,this._rotateLayerOriginY);var n=this._$rotateLayer.getBoundingClientRect();this._rotateLayerX+=(a.left-n.left)/i,this._rotateLayerY+=(a.top-n.top)/i,M(this._$rotateLayer,this._rotateLayerX+this._moveLayerPaddingLeft,this._rotateLayerY+this._moveLayerPaddingTop,this._curAngle)}},{key:"_rotateLayerRotate",value:function(t){M(this._$rotateLayer,this._rotateLayerX+this._moveLayerPaddingLeft,this._rotateLayerY+this._moveLayerPaddingTop,t),this._curAngle=t}},{key:"_rotateLayerRotateFinish",value:function(t,e){var i=this;M(this._$rotateLayer,this._rotateLayerX+this._moveLayerPaddingLeft,this._rotateLayerY+this._moveLayerPaddingTop,t);var o=this._iScroll,r=o.scale,a=o.options,n=this._$rotateLayer.getBoundingClientRect();this._rotateLayerWidth=n.width/r,this._rotateLayerHeight=n.height/r,P(this._$rotateLayer,0,0);var s=this._$rotateLayer.getBoundingClientRect();M(this._$rotateLayer,this._rotateLayerX+this._moveLayerPaddingLeft,this._rotateLayerY+this._moveLayerPaddingTop,0);var l=this._$rotateLayer.getBoundingClientRect();this._rotateLayerX=(l.left-s.left)/r,this._rotateLayerY=(l.top-s.top)/r,this._calcScale(),this._resizeMoveLayer();var u=this._$moveLayer.getBoundingClientRect(),h={x:n.left-this._moveLayerPaddingLeft*r-u.left,y:n.top-this._moveLayerPaddingTop*r-u.top};o.scrollTo(o.x+h.x,o.y+h.y),this._refreshScroll(o.options.bounceTime);var c,f,p,_,d,y,m=Math.max(a.zoomMin,Math.min(a.zoomMax,r));if(m!==r&&(h.x=h.x/r*m,h.y=h.y/r*m),o.startX+=h.x,o.startY+=h.y,t!==this._curAngle&&e&&(0,L.default)(e)&&void 0!==x){h={x:(s.left-n.left)/r,y:(s.top-n.top)/r},P(this._$rotateLayer,this._rotateLayerOriginX,this._rotateLayerOriginY);var g=this._rotateLayerX+this._moveLayerPaddingLeft+h.x,v=this._rotateLayerY+this._moveLayerPaddingTop+h.y;M(this._$rotateLayer,g,v,this._curAngle),this._atRotation=!0,c=this._$rotateLayer,f=g,p=v,_=t,d=e,y=function(){i._atRotation=!1,i._rotateFinishUpdataElem(t)},(0,b.default)(c,z+"transform"),(0,b.default)(c,z+"transition",z+"transform "+d+"ms cubic-bezier(0.1, 0.57, 0.1, 1)"),M(c,f,p,_),setTimeout(function(){(0,b.default)(c,z+"transition",""),y()},d)}else this._rotateFinishUpdataElem(t)}},{key:"_rotateFinishUpdataElem",value:function(t){P(this._$rotateLayer,this._rotateLayerOriginX=0,this._rotateLayerOriginY=0),M(this._$rotateLayer,this._rotateLayerX+this._moveLayerPaddingLeft,this._rotateLayerY+this._moveLayerPaddingTop,this._curAngle=t%360)}},{key:"_initFile",value:function(){var e=this,t=this._options;(this._fileList=(0,y.default)(t.file))&&this._fileList.forEach(function(t){S||(0,d.default)(t,"accept","image/jpeg, image/x-png, image/png, image/gif"),t.addEventListener("change",e._fileOnChangeHandle)})}},{key:"_fileOnChangeHandle",value:function(t){var e=t.target.files;e.length&&this._lrzHandle(e[0])}},{key:"_lrzHandle",value:function(t){var e=this,i=this._options,o=i.errorMsg;if("object"===g(t)&&t.type&&!/image\/\w+/.test(t.type))return i.loadError.call(this,o.imgError),!1;this._imgLoaded=!1,i.loadStart.call(this,t);try{(0,a.default)(t,i.lrzOption).then(function(t){e._clearImg(),e._createImg(t.base64)}).catch(function(t){i.loadError.call(e,o.imgHandleError,t)})}catch(t){throw i.loadError.call(this,o.imgHandleError,t),t}}},{key:"_clearImg",value:function(){this._$img&&(this._$img.onload=null,this._$img.onerror=null,(0,p.default)(this._$img),this._$img=null,this._imgLoaded=!1)}},{key:"_createImg",value:function(t){var i=this,o=this._options,e=o.errorMsg;this._$img=new Image,(0,b.default)(this._$img,{display:"block","user-select":"none","pointer-events":"none"}),this._$img.onload=function(t){var e=t.target;i._imgLoaded=!0,o.loadComplete.call(i,e),i._$rotateLayer.appendChild(e),i._rotateLayerWidth=e.naturalWidth,i._rotateLayerHeight=e.naturalHeight,(0,b.default)(i._$rotateLayer,{width:i._rotateLayerWidth,height:i._rotateLayerHeight}),(0,_.default)([e,i._$moveLayer],i._resetScroll)},this._$img.onerror=function(t){o.loadError.call(i,e.imgLoadError,t)},(0,d.default)(this._$img,"src",t)}},{key:"_clipImg",value:function(){var e=this._options,i=e.errorMsg;if(this._imgLoaded){var t=m.loaclToLoacl(this._$moveLayer,this._$clipLayer),o=this._iScroll.scale,r=this._canvas.getContext("2d"),a=1,n=1;this._outputWidth||this._outputHeight?(this._canvas.width=this._outputWidth,this._canvas.height=this._outputHeight,a=this._outputWidth/this._clipWidth*o,n=this._outputHeight/this._clipHeight*o):(this._canvas.width=this._clipWidth/o,this._canvas.height=this._clipHeight/o),r.clearRect(0,0,this._canvas.width,this._canvas.height),r.fillStyle="image/png"===e.outputType?"transparent":e.style.jpgFillColor,r.fillRect(0,0,this._canvas.width,this._canvas.height),r.save(),r.scale(a,n),r.translate(this._rotateLayerX+this._moveLayerPaddingLeft-t.x/o,this._rotateLayerY+this._moveLayerPaddingTop-t.y/o),r.rotate(this._curAngle*Math.PI/180),r.drawImage(this._$img,0,0),r.restore();try{var s=this._canvas.toDataURL(e.outputType,e.outputQuality);return this._viewList&&this._viewList.forEach(function(t){(0,b.default)(t,"background-image","url(".concat(s,")"))}),e.done.call(this,s),s}catch(t){throw e.fail.call(this,i.clipError),t}}else e.fail.call(this,i.noImg)}},{key:"_resize",value:function(t,e){(0,_.default)(this._$container,function(){this._containerWidth=this._$container.offsetWidth,this._containerHeight=this._$container.offsetHeight},this);var i=this._options.size,o=this._clipWidth,r=this._clipHeight;if((0,L.default)(t)&&(i[0]=t),(0,L.default)(e)&&(i[1]=e),this._widthIsPercent||this._heightIsPercent){var a=i[0]/i[1];this._widthIsPercent&&(this._clipWidth=this._containerWidth/100*parseFloat(this._widthIsPercent),this._heightIsPercent||(this._clipHeight=this._clipWidth/a)),this._heightIsPercent&&(this._clipHeight=this._containerHeight/100*parseFloat(this._heightIsPercent),this._widthIsPercent||(this._clipWidth=this._clipHeight*a))}else this._clipWidth=i[0],this._clipHeight=i[1];var n=this._clipWidth,s=this._clipHeight;if(this._clipSizeRatio=n/s,this._outputWidth&&!this._outputHeight&&(this._outputHeight=this._outputWidth/this._clipSizeRatio),this._outputHeight&&!this._outputWidth&&(this._outputWidth=this._outputHeight*this._clipSizeRatio),(0,b.default)(this._$clipLayer,{width:n,height:s,"margin-left":-n/2,"margin-top":-s/2}),(0,b.default)(this._$mask_left,{"margin-right":n/2,"margin-top":-s/2,"margin-bottom":-s/2}),(0,b.default)(this._$mask_right,{"margin-left":n/2,"margin-top":-s/2,"margin-bottom":-s/2}),(0,b.default)(this._$mask_top,{"margin-bottom":s/2}),(0,b.default)(this._$mask_bottom,{"margin-top":s/2}),(0,b.default)(this._$clip_frame,{width:n,height:s}),(0,b.default)(this._$clip_frame,z+"transform","translate(-50%, -50%)"),n!==o||s!==r){this._calcScale(),this._resizeMoveLayer(),this._refreshScroll();var l=this._iScroll,u=l.scale,h=.5*(n-o)*u,c=.5*(s-r)*u;l.scrollBy(h,c)}}},{key:"size",value:function(t,e){return this._resize(t,e),this}},{key:"load",value:function(t){return this._lrzHandle(t),this}},{key:"clear",value:function(){return this._clearImg(),this._resetScroll(),this._fileList&&this._fileList.forEach(function(t){t.value=""}),this}},{key:"rotate",value:function(t,e){return void 0===t?this._curAngle:(this._rotateTo(t,e),this)}},{key:"scale",value:function(t,e){return void 0===t?this._iScroll.scale:(this._iScroll.zoom(t,void 0,void 0,e),this)}},{key:"clip",value:function(){return this._clipImg()}},{key:"destroy",value:function(){var i=this;window.removeEventListener("resize",this._resize),this._$container.removeChild(this._$clipLayer),this._$container.removeChild(this._$mask),(0,b.default)(this._$container,this._containerOriginStyle),this._iScroll&&this._iScroll.destroy(),this._hammerManager?(this._hammerManager.off("rotatemove"),this._hammerManager.off("rotateend"),this._hammerManager.destroy()):this._$moveLayer.removeEventListener("dblclick",this._rotateCW90),this._$img&&(this._$img.onload=null,this._$img.onerror=null),this._viewList&&this._viewList.forEach(function(t,e){(0,b.default)(t,i._viewOriginStyleList[e])}),this._fileList&&this._fileList.forEach(function(t){t.removeEventListener("change",i._fileOnChangeHandle),t.value=null}),this._okList&&this._okList.forEach(function(t){t.removeEventListener("click",i._clipImg)}),(0,l.default)(this)}}])&&v(t.prototype,e),o&&v(t,o),i;var t,e,o}();function P(t,e,i){e=(e||0).toFixed(2),i=(i||0).toFixed(2),(0,b.default)(t,z+"transform-origin",e+"px "+i+"px")}function M(t,e,i,o){e=e.toFixed(2),i=i.toFixed(2),o=o.toFixed(2),(0,b.default)(t,z+"transform","translateZ(0) translate("+e+"px,"+i+"px) rotate("+o+"deg)")}t.default=w,H.exports=E.default})?e.apply(E,i):e)||(H.exports=o)},function(t,e){t.exports=i},function(t,e){t.exports=o},function(t,e){t.exports=r},function(t,e,i){var o,r,a;r=[],void 0===(a="function"==typeof(o=function(){"use strict";t.exports=function(e){for(var t=arguments.length,i=new Array(1<t?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];i.forEach(function(t){e[t]=e[t].bind(e)})}})?o.apply(e,r):o)||(t.exports=a)},function(t,e,i){var o,r,a;r=[],void 0===(a="function"==typeof(o=function(){"use strict";t.exports=function(e){Object.getOwnPropertyNames(e).forEach(function(t){delete e[t]}),e.__proto__=Object.prototype}})?o.apply(e,r):o)||(t.exports=a)},function(t,e,i){var o,r,a;r=[],void 0===(a="function"==typeof(o=function(){"use strict";var h=i(0),c=i(1),f=i(11),p=i(12),_=i(13);t.exports=function t(){var e,i,o,r,a,n=arguments[0]||{},s=(Object.prototype.toString,1),l=arguments.length,u=!1;for(f(n)&&(u=n,n=arguments[s]||{},s++),c(n)||p(n)||(n={}),s===l&&(n=this,s--);s<l;s++)if(null!=(e=arguments[s]))for(i in e)o=n[i],r=e[i],n!==r&&(u&&r&&((a=h(r))||_(r))?(o=a?(a=!1,o&&h(o)?o:[]):o&&_(o)?o:{},n[i]=t(u,o,r)):void 0!==r&&(n[i]=r));return n}})?o.apply(e,r):o)||(t.exports=a)},function(t,e,i){var o,r,a;r=[],void 0===(a="function"==typeof(o=function(){"use strict";t.exports=function(t){return"boolean"==typeof t}})?o.apply(e,r):o)||(t.exports=a)},function(t,e,i){var o,r,a;r=[],void 0===(a="function"==typeof(o=function(){"use strict";t.exports=function(t){return"function"==typeof t}})?o.apply(e,r):o)||(t.exports=a)},function(t,e,i){var o,r,a;r=[],void 0===(a="function"==typeof(o=function(){"use strict";t.exports=function(t){return"[object Object]"===Object.prototype.toString.call(t)}})?o.apply(e,r):o)||(t.exports=a)},function(t,e,i){var o,r,a;r=[],void 0===(a="function"==typeof(o=function(){"use strict";t.exports=function(t){return/%$/.test(t+"")}})?o.apply(e,r):o)||(t.exports=a)},function(t,e,i){var o,r,a;r=[],void 0===(a="function"==typeof(o=function(){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}t.exports=function(t,e,i,o){var r=document.createElement("DIV");if("object"===n(e)&&(o=e,e=null),"object"===n(i)&&(o=i,i=null),"object"===n(o))for(var a in o)r.style[a]=o[a];return e&&(r.className=e),i&&(r.id=i),t.appendChild(r),r}})?o.apply(e,r):o)||(t.exports=a)},function(t,e,i){var o,r,a;r=[],void 0===(a="function"==typeof(o=function(){"use strict";t.exports=function(t){t.parentNode&&t.parentNode.removeChild(t)}})?o.apply(e,r):o)||(t.exports=a)},function(t,e,i){var o,r,a;r=[],void 0===(a="function"==typeof(o=function(){"use strict";t.exports=function(t,e){var i=e?t:"",o=document.documentElement;if(t in o.style)return i;for(var r,a=t.charAt(0).toUpperCase()+t.substr(1),n=["Webkit","Moz","ms","O"],s=0;r=n[s++];)if(r+a in o.style)return"-"+r.toLowerCase()+"-"+i;return i}})?o.apply(e,r):o)||(t.exports=a)},function(t,e,i){var o,r,a;r=[],void 0===(a="function"==typeof(o=function(){"use strict";var r=i(1),a=i(2),n={animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0};t.exports=function(t,e,i){if(r(e)){for(var o in e)i=e[o],a(i)&&!n[e]&&(i+="px"),t.style[o]=i;return t}return void 0===i?window.getComputedStyle(t)[e]:(a(i)&&!n[e]&&(i+="px"),t.style[e]=i,t)}})?o.apply(e,r):o)||(t.exports=a)},function(t,e,i){var o,r,a;r=[],void 0===(a="function"==typeof(o=function(){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}t.exports=function(t,e,i){if("object"!==r(e))return void 0===i?t[e]:(t[e]=i,t);for(var o in e)t[o]=e[o];return t}})?o.apply(e,r):o)||(t.exports=a)},function(t,e,r){var i,o,a;o=[],void 0===(a="function"==typeof(i=function(){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=r(21);t.exports=function(t,e){return t instanceof HTMLElement?[t]:"object"===i(t)&&t.length?o(t):t&&"string"==typeof t?("string"==typeof e&&(e=document.querySelector(e)),e instanceof HTMLElement||(e=document),o(e.querySelectorAll(t))):[]}})?i.apply(e,o):i)||(t.exports=a)},function(t,e,i){var o,r,a;r=[],void 0===(a="function"==typeof(o=function(){"use strict";t.exports=function(t){return Array.prototype.map.call(t,function(t){return t})}})?o.apply(e,r):o)||(t.exports=a)},function(t,e,i){var o,r,a;r=[e,i(3)],void 0===(a="function"==typeof(o=function(t,n){"use strict";function a(t){return t/180*Math.PI}var e;Object.defineProperty(t,"__esModule",{value:!0}),t.getScale=function(t,e,i,o){var r=t/i,a=e/o;return a<r?r:a},t.pointRotate=function(t,e){var i=a(e),o=Math.sin(i),r=Math.cos(i);return{x:r*t.x-o*t.y,y:r*t.y+o*t.x}},t.angleToRadian=a,t.loaclToLoacl=function(t,e,i,o){var r,a;return i=i||0,o=o||0,(0,n.default)([t,e],function(){r=t.getBoundingClientRect(),a=e.getBoundingClientRect()}),{x:a.left-r.left+i,y:a.top-r.top+o}},t.globalToLoacl=function(t,e,i){var o;return e=e||0,i=i||0,(0,n.default)(t,function(){o=t.getBoundingClientRect()}),{x:e-o.left,y:i-o.top}},n=(e=n)&&e.__esModule?e:{default:e}})?o.apply(e,r):o)||(t.exports=a)}])});