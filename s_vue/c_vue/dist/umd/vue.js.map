{"version":3,"file":"vue.js","sources":["../../src/observer/array.js","../../src/utils.js","../../src/observer/dep.js","../../src/observer/index.js","../../src/observer/watcher.js","../../src/state.js","../../src/compiler/html-parser.js","../../src/compiler/generate.js","../../src/compiler/index.js","../../src/vdom/patch.js","../../src/lifecycle.js","../../src/init.js","../../src/vdom/index.js","../../src/global-api/extend.js","../../src/global-api/index.js","../../src/index.js"],"sourcesContent":["let oldArrayProtoMethods = Array.prototype\n\n// 继承\nexport let arrayMethods = Object.create(oldArrayProtoMethods)\n\nlet methods = [\n    'push',\n    'pop',\n    'shift',\n    'unshift',\n    'reverse',\n    'sort',\n    'splice',\n]\nmethods.forEach(method => {\n    arrayMethods[method] = function (...args) {\n        // console.log(method + '被调用了')\n        const result = oldArrayProtoMethods[method].apply(this, args)\n        const ob = this.__ob__\n        let inserted  // 表示数组新增的数据，也要做拦截\n        switch (method) {\n            case 'push':\n            case 'unshift':\n                inserted = args\n                break;\n            case 'splice':\n                inserted = args.slice(2)\n                break;\n        }\n\n        if (inserted) ob.observeArray(inserted)  // 新增加的数据也要观测\n\n        ob.dep.notify()\n        return result\n    }\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","import {nonenumerable} from \"core-decorators\";\n\nexport function proxy(vm, data, key) {\n    Object.defineProperty(vm, key, {\n        get() {\n            return vm[data][key]\n        },\n        set(newValue) {\n            vm[data][key] = newValue\n        }\n    })\n}\n\nexport function defineProperty(data, key, value) {\n    Object.defineProperty(data, key, {\n        enumerable: false,\n        configurable: false,\n        value\n    })\n}\n\n// 合并策略\nconst strats = {}\nconst defaultStrat = strats.data = function (parentVal, childVal) {\n    if (childVal) {\n        return childVal\n    }\n    return parentVal\n}\nstrats.components = function (parentVal, childVal) {\n    // 先找儿子，再找全局\n    const res = Object.create(parentVal)\n    if (childVal) {\n        for (let key in childVal) {\n            res[key] = childVal[key]\n        }\n    }\n    return res\n}\n\nfunction mergeHook(parentVal, childVal) {\n    if (childVal) {\n        if (parentVal) {\n            return parentVal.concat(childVal)\n        } else {\n            return [childVal]\n        }\n    } else {\n        return parentVal\n    }\n}\n\nconst LIFECYCLE_HOOKS = [\n    'beforeCreate',\n    'created',\n    'beforeMount',\n    'mounted',\n    'beforeUpdate',\n    'updated',\n    'beforeDestroy',\n    'destroyed'\n]\n\nLIFECYCLE_HOOKS.forEach(hook => {\n    strats[hook] = mergeHook\n})\n\nexport function mergeOptions(parent, child) {\n    const options = {}\n    // 父有\n    for (let key in parent) {\n        mergeField(key)\n    }\n\n    // 父没有，子有\n    for (let key in child) {\n        if (!parent.hasOwnProperty(key)) {\n            mergeField(key)\n        }\n    }\n\n    function mergeField(key) {\n        const strat = strats[key] || defaultStrat\n        console.log('-----', parent, child, key)\n        // 如果是生命周期\n        options[key] = strat(parent[key], child[key])\n    }\n\n    return options\n}\n\nconst callbacks = []\nlet pending = false\n\nfunction flushCallbacks() {\n    // callbacks.forEach(cb => cb())\n    // callbacks = []\n    while (callbacks.length) {\n        let cb = callbacks.pop()\n        cb()\n    }\n    pending = false\n}\n\nlet timerFunc\nif (Promise) {\n    timerFunc = () => {\n        Promise.resolve().then(flushCallbacks)\n    }\n} else if (MutationObserver) {\n    let observer = new MutationObserver(flushCallbacks)\n    let textNode = document.createTextNode(1)\n    observer.observe(textNode, {characterData: true})\n    timerFunc = () => {\n        textNode.textContent = 2\n    }\n} else if (setImmediate) {\n    setImmediate(flushCallbacks)\n} else {\n    setTimeout(flushCallbacks)\n}\n\nexport function nextTick(cb) {\n    console.log('---', cb)\n    callbacks.push(cb)\n    if (!pending) {\n        timerFunc()\n        pending = true\n    }\n}\n\nfunction makeMap(str) {\n    const mapping = {}\n    str.split(',').map(item => {\n        mapping[item] = true\n    })\n    return function (key) {\n        return mapping[key]\n    }\n}\n\n// 是否是原生标签\nexport const isReservedTag = makeMap(\n    `a,div,img,text,span,p,button,ul,li,html,body,input,textarea,select`\n)\n","// 发布订阅模式\nlet id = 0  // 每个属性 的 id 相同，防止 {{a.x}} 多次使用时，重复更新\n\nclass Dep {\n    constructor() {\n        this.subs = []\n        this.id = id++\n    }\n\n    depend() {\n        if (Dep.target) {\n            Dep.target.addDep(this)\n        }\n    }\n\n    addSub(watcher) {\n        this.subs.push(watcher)\n    }\n\n    notify() {\n        console.log('this.subs, ', this.subs)\n        this.subs.forEach(sub => {\n            sub.update()\n        })\n    }\n}\n\nDep.target = null\nconst stack = []\n\nexport function pushTarget(watcher) {\n    Dep.target = watcher\n    stack.push(watcher) // 可能有 属性watcher 或渲染watcher\n}\n\nexport function popTarget() {\n    stack.pop()\n    Dep.target = stack[stack.length - 1]\n}\n\nexport default Dep\n","import {arrayMethods} from './array'\nimport {defineProperty} from \"../utils\";\nimport Dep from \"./dep\";\n\nclass Observer {\n    constructor(value) {\n        // 1. 挂 dep，用于数组的更新，通过 dep 可以找到数组的 watcher\n        // 2. 对象的 Vue.$set 方法也要用到\n        this.dep = new Dep()\n\n        // 这里给 value 增加 __ob__ 但是不能被枚举，否则会死循环\n        // 另外 array 里新数据 监测也要用到 observeArray 方法\n        defineProperty(value, '__ob__', this)\n\n        // 使用 defineProperty 重写属性\n        // console.log(value)\n        if (Array.isArray(value)) {\n            // 如果是数组，就不要对索引进行 definePropery 了，为了性能\n            value.__proto__ = arrayMethods\n            this.observeArray(value)\n        } else {\n            this.walk(value)\n        }\n    }\n\n    observeArray(value) {\n        value.forEach(item => {\n            observe(item)\n        })\n    }\n\n    walk(value) {\n        Object.keys(value).forEach(key => {\n            defineReactive(value, key, value[key])\n        })\n    }\n}\n\nfunction defineReactive(data, key, value) {\n    const childDep = observe(value)\n\n    const dep = new Dep()\n    Object.defineProperty(data, key, {\n        get() {\n            if (Dep.target) {\n                dep.depend()  // 说明走渲染了\n                if (childDep) {\n                    childDep.dep.depend() // 数组 depend\n                }\n            }\n            // console.log('取值了')\n            return value\n        },\n        set(newValue) {\n            if (value === newValue) return\n            // 如果是重写对象\n            observe(newValue)\n            // console.log('设置了值')\n            value = newValue   // 这里 value 是个闭包\n\n            dep.notify()\n        }\n    })\n}\n\nexport function observe(data) {\n    // console.log('observe', data)\n    if (typeof data !== 'object' || data === null) {\n        // console.error('data 必须是对象或函数')\n        return\n    }\n    // 有 __ob__ 表示被拦截了的\n    if (data.__ob__ instanceof Observer) {\n        return data\n    }\n    return new Observer(data)\n}\n","import {pushTarget, popTarget} from './dep'\n\nlet id = 0  // watcher 的id\n\nclass Watcher {\n    constructor(vm, exprOrFn, cb, options) {\n        this.vm = vm\n        this.exprOrFn = exprOrFn\n        this.cb = cb\n        this.options = options\n        this.user = options.user  // 用户写的 watcher\n        // 渲染 watcher\n        this.isWatcher = options === true\n        this.lazy = options.lazy\n        this.dirty = this.lazy // 取值时是否执行用户\n\n        this.id = id++\n        this.deps = []\n        this.depsId = new Set()\n\n        if (typeof exprOrFn === 'function') {\n            this.getter = exprOrFn\n        } else {\n            // 用户写的 watcher\n            this.getter = function () {\n                let path = exprOrFn.split('.')\n                let obj = vm\n                for (let i = 0; i < path.length; i++) {\n                    obj = obj[path[i]]\n                }\n                // 获取观测对象的值\n                return obj\n            }\n        }\n\n        // 计算属性，默认不执行\n        this.value = this.lazy ? void 0 : this.get()  // 只有实例化时，才有 getter\n    }\n\n    addDep(dep) {\n        let id = dep.id\n        if (!this.depsId.has(id)) {\n            this.deps.push(dep)\n            this.depsId.add(id)\n            dep.addSub(this)\n            // console.log(dep)\n        }\n    }\n\n    get() {\n        console.log('update')\n        pushTarget(this)\n        let result = this.getter.call(this.vm)\n        popTarget()\n\n        return result\n    }\n\n    run() {\n        let newValue = this.get()\n        let oldValue = this.value\n        if (this.user) {\n            this.cb.call(this.vm, newValue, oldValue)\n        }\n        // this.get()\n    }\n\n    update() {\n        // 计算属性，只需要 dirty = true，不需要更新值，取值是会自动更新\n        if (this.lazy) {\n            this.dirty = true\n            return\n        }\n        // this.get()  // 重新渲染\n        queueWatcher(this)  // 暂存队列后异步更新\n    }\n\n    evaluate() {\n        // get() 求值时，会记住计算属性的 watcher\n        this.value = this.get()\n        this.dirty = false  // 取过值了，不再重新取值\n    }\n\n    depend() {\n        // 遍历 dep，将渲染 watcher 放进行\n        // for (let i = 0; i < this.deps.length; i++) {\n        //     this.deps[i].depend()\n        // }\n        let i = this.deps.length\n        while(i--){\n            this.deps[i].depend()\n        }\n    }\n}\n\nlet queue = []\nlet has = {}\nlet pending = false\n\nfunction flushSchedulerQueue() {\n    queue.forEach(watcher => {\n        watcher.run()\n    })\n    queue = []\n    has = {}\n    pending = false\n}\n\nfunction queueWatcher(watcher) {\n    const id = watcher.id\n    if (has[id] == null) {\n        queue.push(watcher) // 组件只更新一次\n        has[id] = true\n        if (!pending) {\n            watcher.vm.$nextTick(flushSchedulerQueue)\n            // setTimeout(() => {\n            //     queue.forEach(watcher => watcher.run())\n            //     queue = []\n            //     has = {}\n            //     pending = false\n            // }, 0)\n            pending = true\n        }\n    }\n}\n\nexport default Watcher\n","import {observe} from './observer/index'\nimport {proxy, nextTick,} from \"./utils\";\nimport Watcher from './observer/watcher'\nimport Dep from \"./observer/dep\";\n\nexport function initState(vm) {\n    console.log(vm)\n    const opts = vm.$options\n    if (opts.props) initProps(vm)\n    if (opts.methods) initMethods(vm)\n    if (opts.data) initData(vm)\n    if (opts.computed) initComputed(vm)\n    if (opts.watch) initWatch(vm)\n}\n\nfunction initProps() {\n\n}\n\nfunction initMethods() {\n\n}\n\nfunction initData(vm) {\n    let data = vm.$options.data\n    console.log('initData', vm)\n    // data 可能是对象 或函数\n    data = typeof data === 'function' ? data.call(vm) : data\n    vm._data = data\n\n    // 代理\n    for (let key in data) {\n        proxy(vm, '_data', key)\n    }\n\n    // 将data变为响应式\n    observe(data)\n    console.log(vm._data.a)\n}\n\nfunction initComputed(vm) {\n    const watcher = vm._computedWatchers = {}\n    let computed = vm.$options.computed\n    console.log(computed)\n    for (let key in computed) {\n        const userDef = computed[key]\n        const getter = typeof userDef === 'function' ? userDef : userDef.get\n\n        // 懒 watcher，lazy 就是计算属性，依赖收集\n        // 每个 computed 里的属性都有一个 watcher\n        watcher[key] = new Watcher(vm, getter, () => {\n        }, {lazy: true})\n        // 将computed 的 key 全挂到 vm 上\n        defineComputed(vm, key, userDef)\n    }\n}\n\nfunction defineComputed(vm, key, userDef) {\n    const sharedPropertyDefinition = {\n        enumerable: true,\n        configurable: true,\n        get: () => {\n        },\n        set: () => {\n        }\n    }\n    if (typeof userDef === 'function') {\n        sharedPropertyDefinition.get = createComputedGetter(key)\n    } else {\n        sharedPropertyDefinition.get = createComputedGetter(key)\n        sharedPropertyDefinition.set = userDef.set\n    }\n    Object.defineProperty(vm, key, sharedPropertyDefinition)\n}\n\n// 计算属性的缓存\nfunction createComputedGetter(key) {\n    return function () {\n        // 计算属性的 watcher\n        const watcher = this._computedWatchers[key]\n        if (watcher) {\n            if (watcher.dirty) {\n                // 计算属性求值\n                watcher.evaluate()\n            }\n            // 如果 Dep.target 还有值，就也收集\n            if (Dep.target) {\n                console.log('gggggg')\n                watcher.depend()\n            }\n\n            return watcher.value\n        }\n    }\n}\n\nfunction initWatch(vm) {\n    let watch = vm.$options.watch\n\n    for (let key in watch) {\n        const handler = watch[key]\n        if (Array.isArray(handler)) {  // 数组\n            handler.forEach(handle => {\n                createWatcher(vm, key, handle)\n            })\n        } else {\n            createWatcher(vm, key, handler)  // 对象 字符串 函数\n        }\n    }\n}\n\n// key 可以是一个函数，是执行后的结果\n// options 可以标记watcher是用户watcher\nfunction createWatcher(vm, exprOrFn, handler, options) {\n    if (typeof handler === \"object\") {\n        options = handler  // {immediate, deep ,sync}\n        handler = handler.handler\n    }\n    if (typeof handler === 'string') {\n        handler = vm[handler]\n    }\n\n    return vm.$watch(exprOrFn, handler, options)\n}\n\nexport function stateMixin(Vue) {\n    Vue.prototype.$nextTick = function (cb) {\n        nextTick(cb)\n    }\n\n    Vue.prototype.$watch = function (exprOrFn, handler) {\n        new Watcher(this, exprOrFn, handler, {\n            user: true\n        })\n    }\n}\n","const attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`  // 匹配标签名\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`        // 匹配结束  </my:xx>\nconst startTagOpen = new RegExp(`^<${qnameCapture}`)    // 标签开始\nconst startTagClose = /^\\s*(\\/?)>/                            // 标签关闭      >   />\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`)    // 匹配标签结尾 </div>\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g      // {{xx}}\n\nfunction parseHTML(html) {\n    let root\n    let currentParent\n    let stack = []  // 用于检查 标签嵌套是否正确\n\n    function start(tagName, attrs) {\n        let element = createASTElement(tagName, attrs)\n        if (!root) {\n            root = element\n        }\n        currentParent = element\n        stack.push(element)\n        // console.log(tagName, attrs, `-–––${tagName}开始-------`)\n    }\n\n    function end(tagName) {\n        // console.log(tagName, `-–––${tagName}结束-------`)\n        let element = stack.pop()\n        currentParent = stack[stack.length - 1]\n        if (currentParent) {\n            element.parent = currentParent\n            currentParent.children.push(element)\n        }\n    }\n\n    function chars(text) {\n        text = text.trim()\n        if (text) {\n            currentParent.children.push({\n                type: 3,\n                text\n            })\n        }\n        // console.log(text, '------文本------')\n    }\n\n    function createASTElement(tagName, attrs) {\n        return {\n            tag: tagName,\n            type: 1,\n            children: [],\n            attrs,\n            parent: null\n        }\n    }\n\n    function advance(n) {\n        html = html.substring(n)\n    }\n\n    function parseStartTag() {\n        const start = html.match(startTagOpen)\n        // console.log('start', start)\n        if (start) {\n            const match = {\n                tagName: start[1],\n                attrs: []\n            }\n            advance(start[0].length) // 删除匹配到的字符\n\n            let end\n            // 如果没有匹配到结束标签\n            while (!(end = html.match(startTagClose))) {\n                let attrs = html.match(attribute)\n                match.attrs.push({\n                    name: attrs[1],\n                    value: attrs[3]\n                })\n                advance(attrs[0].length)\n            }\n            if (end) {\n                // console.log(match)\n                advance(end[0].length)\n                return match\n            }\n        }\n    }\n\n    while (html) {\n        let textEnd = html.indexOf('<')\n        if (textEnd === 0) {\n            const startTagMatch = parseStartTag(html)\n            if (startTagMatch) {\n                start(startTagMatch.tagName, startTagMatch.attrs)\n                continue\n            }\n            const endTagMatch = html.match(endTag)\n            if (endTagMatch) {\n                advance(endTagMatch[0].length)\n                end(endTagMatch[1])\n                continue\n            }\n        }\n        let text\n        if (textEnd > 0) {\n            text = html.substring(0, textEnd)\n        }\n        if (text) {\n            advance(text.length)\n            chars(text)\n        }\n    }\n    return root\n}\n\nexport default parseHTML\n","const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\nfunction genProps(attrs) {\n    let str = '';\n    for (let i = 0; i < attrs.length; i++) {\n        let attr = attrs[i]; // name,value\n        if (attr.name === 'style') {\n            let obj = {};\n            attr.value.split(';').forEach(item => {\n                let [key, value] = item.split(':');\n                obj[key] = value\n            });\n            attr.value = obj; // {style:{color:red}}\n        }\n        str += `${attr.name}:${JSON.stringify(attr.value)},` // {a:'aaa',a:1,b:2,}\n    }\n    return `{${str.slice(0,-1)}}`;\n}\n\nfunction genChildren(el) {\n    const children  = el.children;\n    if(children){\n        return children.map(child=>gen(child)).join(',')\n    }\n}\nfunction gen(node){ // 区分是元素 还是文本\n    if(node.type == 1){\n        return generate(node);\n    }else{\n        //文本 逻辑不能用 _c来处理\n        // 有{{}} 普通文本  混合文本 {{aa}} aaa {{bbb}} ccc\n        let text =  node.text;\n        if(defaultTagRE.test(text)){ // _v(_s(name) + 'aa' + _s(age) + '哈哈'）\n            let tokens = [];\n            let match ;\n            let index = 0;\n            let lastIndex = defaultTagRE.lastIndex = 0;\n            while(match = defaultTagRE.exec(text)){ // aa {{ age }} haha \n                index = match.index;\n                if(index >lastIndex){\n                    tokens.push(JSON.stringify(text.slice(lastIndex,index)));\n                }\n                tokens.push(`_s(${match[1].trim()})`);\n                lastIndex = index + match[0].length;\n            }\n            if(lastIndex < text.length){\n                tokens.push(JSON.stringify(text.slice(lastIndex)))\n            }\n            return  `_v(${tokens.join('+')})`\n\n            // 是带有{{}}\n        }else{\n            return `_v(${JSON.stringify(text)})`\n        }\n    }\n}\nexport function generate(el) {\n    // console.log(el); // 转换成render代码\n    let children = genChildren(el);\n    let code = `_c('${el.tag}',${\n        el.attrs.length? genProps(el.attrs):'undefined'\n    } ${\n        children? (',' + children) : ''\n    })`;\n    // => js代码 html=> js代码  字符串拼接\n    return code;\n}\n\n\n/* \n<div id=\"app\" a=1 b=2>\n    <span style\"=color:red\">{{name}} <a>hello</a></span>\n</div> \n _c(\n    'div',{id:'app',a:1,b:2}\n    ,_c(\n        'span',\n        {style:{color:'red'}}\n        ,_s(_v(name)),\n        _c(a,undefined,_v('hello'))\n        )\n)\n*/","import parseHTML from \"./html-parser\";\nimport {generate} from './generate'\n\nexport function compileToFunction(template) {\n    // 1. 将 html 转为 ast 语法树\n    let ast = parseHTML(template)\n    console.log('ast', ast)\n\n    // 2. 优化静态节点\n\n    // 3. 将 ast 生成为代码\n    let code = generate(ast)\n\n    // 生成函数\n    let render = new Function(`with(this){return ${code}}`)\n\n    console.log(render)\n    return render\n}\n","export function patch(oldVnode, vnode) {\n    // 如果是组件，就创建组件的虚拟节点\n    if (!oldVnode) {\n        return createElm(vnode);\n    }\n\n    let el\n    // 如果是初始化， oldVnode 是真实元素\n    const isRealElement = oldVnode.nodeType\n    if (isRealElement) {\n        // 根据 vnode 创建真实 dom 节点\n        el = createElm(vnode)\n\n        // 使用新节点替换 oldVnode\n        let parentEl = oldVnode.parentNode\n        // parentEl.replaceChild(el, oldVnode)\n\n        parentEl.insertBefore(el, oldVnode.nextSibling)  //真实元素插入到老节点后面\n        parentEl.removeChild(oldVnode)  //删除老节点\n\n        return el\n    } else {\n        // 对比两个 vnode，然后更新\n        // 1. 标签不同，直接替换\n        if (oldVnode.tag !== vnode.tag) {\n            return oldVnode.el.parentNode.replaceChild(createElm(vnode), oldVnode.el)\n        }\n\n        // 标签一样，内容不一样，文本节点\n        if (!oldVnode.tag) {\n            if (oldVnode.text !== vnode.text) {\n                return oldVnode.el.textContent = vnode.text\n            }\n            return\n        }\n\n        // 标签一样，属性不一样，复用元素，更新属性\n        let el = vnode.el = oldVnode.el\n        updateProperties(vnode, oldVnode.data)\n\n        // 比较儿子\n        let oldChildren = oldVnode.children || []\n        let newChildren = vnode.children || []\n\n        if (oldChildren.length > 0 && newChildren.length > 0) {\n            // 都有儿子节点\n            updateChildren(oldChildren, newChildren, el)\n        } else if (oldChildren.length > 0) {\n            // 新的没有，老的有\n            el.innerHTML = ''\n        } else if (newChildren.length > 0) {\n            // 新的有，老的没有\n            for (let i = 0; i < newChildren.length; i++) {\n                let child = newChildren[i]\n                // 浏览器有性能优化，不用再文档碎片\n                el.appendChild(createElm(child))\n            }\n        }\n    }\n\n}\n\nfunction isSameVnode(newVnode, oldVnode) {\n    return (newVnode.tag === oldVnode.tag) && (newVnode.key === oldVnode.key)\n}\n\nfunction makeIndexByKey(children) {\n    let map = {}\n    children.forEach((item, index) => {\n        map[item.key] = index // {0:A,1:B, 2:C}\n    })\n    return map\n}\n\nfunction updateChildren(oldChildren, newChildren, parent) {\n    let oldStartIndex = 0\n    let oldEndIndex = oldChildren.length - 1\n    let oldStartVnode = oldChildren[oldStartIndex]\n    let oldEndVnode = oldChildren[oldEndIndex]\n\n    let newStartIndex = 0\n    let newStartVnode = newChildren[newStartIndex]\n    let newEndIndex = newChildren.length - 1\n    let newEndVnode = newChildren[newEndIndex]\n\n    let map = makeIndexByKey(oldChildren)\n    console.log('map', map)\n    while (oldStartIndex <= oldEndIndex && newStartIndex <= newEndIndex) {\n        // 从开始比\n        if (!oldStartVnode) {\n            oldStartVnode = oldChildren[++oldStartIndex]\n        } else if (!oldEndVnode) {\n            oldEndVnode = oldEndVnode[--oldEndIndex]\n        } else if (isSameVnode(newStartVnode, oldStartVnode)) {\n            patch(oldStartVnode, newStartVnode)\n            oldStartVnode = oldChildren[++oldStartIndex]\n            newStartVnode = newChildren[++newStartIndex]\n        } else if (isSameVnode(newEndVnode, oldEndVnode)) {\n            // 开始不是同一个节点时有效？ 标签一样key一样 也有效\n            patch(oldEndVnode, newEndVnode)\n            oldEndVnode = oldChildren[--oldEndIndex]\n            newEndVnode = newChildren[--newEndIndex]\n        } else if (isSameVnode(oldStartVnode, newEndVnode)) {\n            // 头尾比  a b c d  -> d c b a\n            // a b c d  -> b c d a\n            patch(oldStartVnode, newEndVnode)\n            // 将老节点移动到末尾元素的后一个\n            parent.insertBefore(oldStartVnode.el, oldEndVnode.el.nextSibling)\n            newEndVnode = newChildren[--newEndIndex]\n            oldStartVnode = oldChildren[++oldStartIndex]\n        } else if (isSameVnode(oldEndVnode, newStartVnode)) {\n            // a b c d  -> d a b c\n            patch(oldStartVnode, newEndVnode)\n            parent.insertBefore(oldEndVnode.el, oldStartVnode.el)\n            oldEndVnode = oldChildren[--oldEndIndex]\n            newStartVnode = newChildren[++newStartIndex]\n            // 为什么要有 key，为什么不能用 key 做索引?\n            // a b c  -> c b a 不能复用元素了，移动 比 创建性能高\n            // input 复用会出问题\n        } else {\n            // 儿子之间没有关系，暴力比对\n            // 根据 oldChildren 做一个 map 表\n            // 新节点如果不在 oldChildren 里，则插入到 oldStartIndex 最前面\n            // 新节点在 oldChildren 里，则将 oldChilren 里的节点移动到指针 oldStartIndex 的前面，并置为 null\n            let moveIndex = map[newStartVnode.key]\n            console.log(moveIndex, newStartVnode.key)\n            if (moveIndex === undefined) {\n                // 没有，直接插入到前面\n                parent.insertBefore(createElm(newStartVnode), oldStartVnode.el)\n            } else {\n                console.log('xxxx')\n                // 有，则移动并替换，最后删除掉不要的\n                let moveVnode = oldChildren[moveIndex]\n                oldChildren[moveIndex] = null\n                parent.insertBefore(moveVnode.el, oldStartVnode.el)\n                patch(moveVnode, newStartVnode)\n            }\n            newStartVnode = newChildren[++newStartIndex]\n        }\n    }\n\n    // 新节点有多的，直接插入\n    if (newStartIndex <= newEndIndex) {\n        for (let i = newStartIndex; i <= newEndIndex; i++) {\n            // 有可能后插入，也有可能前插入\n            // parent.appendChild(createElm(newChildren[i]))\n            let ele = !newChildren[newEndIndex + 1] ? null : newChildren[newEndIndex + 1].el\n            // 如果为 null， insertBefore 会变成 appendChild\n            parent.insertBefore(createElm(newChildren[i]), ele)\n        }\n    }\n\n    // 遍历 oldChilren，删除oldStartIndex oldEndIndex 这个区间的元素\n    if (oldStartIndex <= oldEndIndex) {\n        for (let i = oldStartIndex; i <= oldEndIndex; i++) {\n            let child = oldChildren[i]\n            if (child) {\n                // child.remove()\n                parent.removeChild(child.el)\n            }\n        }\n    }\n}\n\nfunction createComponent(vnode) {\n    let i = vnode.data\n    if ((i = i.hook) && (i = i.init)) {\n        i(vnode)\n    }\n    if (vnode.componentInstance) {\n        return true // 是组件\n    }\n}\n\nexport function createElm(vnode) {\n    const {tag, data, children, text, key} = vnode\n    if (typeof tag === 'string') {\n        // 如果是组件，放在 vm.$el 上\n        if (createComponent(vnode)) {\n            console.log('vnode.componentInstance', vnode.componentInstance)\n            return vnode.componentInstance.$el\n        }\n\n        vnode.el = document.createElement(tag)\n        updateProperties(vnode)\n        children.forEach(child => {\n            console.log(vnode.el)\n            vnode.el.appendChild(createElm(child))\n        })\n    } else if (typeof text === 'string') {\n        vnode.el = document.createTextNode(text)\n    }\n    return vnode.el\n}\n\n\nfunction updateProperties(vnode, oldProps = {}) {\n    let el = vnode.el\n    let newProps = vnode.data\n    // 新的没有，老的有，删除\n    for (let key in oldProps) {\n        if (!newProps[key]) {\n            el.removeAttribute(key)\n        }\n    }\n    // 样式处理，老的有，新的没有，删除老的\n    let newStyle = newProps.style || {}\n    let oldStyle = oldProps.style || {}\n    for (let key in oldStyle) {\n        if (!newStyle[key]) {\n            el.style[key] = ''\n        }\n    }\n\n    // 新的有，直接更新\n    for (let key in newProps) {\n        if (key === 'style') {\n            for (let styleName in newProps.style) {\n                // console.log('newProps.style, ', newProps.style)\n                el.style[styleName] = newProps.style[styleName]\n            }\n            continue\n        } else if (key === 'class') {\n            el.className = newProps[key]\n        } else {\n            el.setAttribute(key, newProps[key])\n        }\n    }\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","import {patch} from './vdom/patch'\nimport Watcher from './observer/watcher'\n\nexport function lifecycleMixin(Vue) {\n\n    Vue.prototype._update = function (vnode) {\n        const vm = this\n        const prevVnode = vm._vnode; // 先取上一次的vnode 看一下是否有\n        if(!prevVnode){ // 首次渲染\n            vm.$el = patch(vm.$el, vnode); // 组件调用patch方法会产生$el属性\n            vm._vnode = vnode // 保存上一次的虚拟节点\n        }else{  // 更新\n            vm.$el = patch(prevVnode,vnode);\n        }\n    }\n\n}\n\nexport function mountComponent(vm) {\n    // 调用 render 方法去渲染 el 属性\n    callHook(vm, 'beforeMount')\n\n    const updateComponent = () => {\n        vm._update(vm._render())\n    }\n    new Watcher(vm, updateComponent, () => {\n        callHook(vm, 'updated')\n    }, true)\n\n    callHook(vm, 'mounted')\n}\n\nexport function callHook(vm, hookName) {\n    const handlers = vm.$options[hookName]\n    // console.log('hooks', hooks, hookName)\n    if (handlers) {\n        handlers.forEach(handler => {\n            handler.call(vm)\n        })\n    }\n}\n","import {initState} from \"./state\";\nimport {compileToFunction} from './compiler/index'\nimport {callHook, mountComponent} from \"./lifecycle\";\nimport {mergeOptions} from \"./utils\";\n\nexport function initMixin(Vue) {\n    Vue.prototype._init = function (options) {\n        const vm = this\n        console.log('options', vm.constructor.options, options)\n        this.$options = mergeOptions(vm.constructor.options, options)\n        callHook(vm, 'beforeCreate')\n        initState(vm)\n        callHook(vm, 'created')\n        // Vue 参考了 MVVM，因为它有 $ref，可以操作 dom\n        // MVVM 是单纯的 M -VM -V，不能跳过数据去更新视图\n\n        // 挂载 dom\n        let el = vm.$options.el\n        if (el) {\n            this.$mount(el)\n        }\n    }\n\n    Vue.prototype.$mount = function (el) {\n        // 获取模版\n        const vm = this\n        const options = vm.$options\n        el = document.querySelector(el)\n        vm.$el = el  // 保存老节点\n\n        // 没有 render，则转 template 为 render\n        if (!options.render) {\n            // 上面已经判断有 el 了\n            let template = options.template\n            if (!template && el) {\n                template = el.outerHTML\n            }\n\n            // 将 options.template 转化为 render\n            const render = compileToFunction(template)\n            options.render = render\n        }\n        console.log(options.render)\n\n        // 通过 render 方法，渲染组件\n        mountComponent(vm, el)\n    }\n}\n","import {isReservedTag} from \"../utils\";\n\nexport function renderMixin(Vue) {\n    // 创建元素节点\n    Vue.prototype._c = function (tag, data, ...children) {\n        return createElement(this, tag, data, ...children)\n    }\n    // 将结果是对象时，对对象取值\n    Vue.prototype._s = function (value) {\n        return value === null ? '' :\n            typeof value === 'object' ? JSON.stringify(value) :\n                value\n    }\n    // 创建文本节点\n    Vue.prototype._v = function (text) {\n        return createTextVNode(text + '')\n    }\n    // 创建虚拟节点\n    Vue.prototype._render = function () {\n        const vm = this\n        const render = vm.$options.render\n\n        let vnode = render.call(vm)\n        return vnode\n    }\n}\n\nfunction createElement(vm, tag, data = {}, ...children) {\n    // 如果是组件，需要创建组件\n    if (isReservedTag(tag)) {\n        return vnode(tag, data, data.key, children)\n    } else {\n        let Ctor = vm.$options.components[tag]\n        return createComponent(vm, tag, data, data.key, children, Ctor)\n    }\n}\n\nfunction createComponent(vm, tag, data, key, children, Ctor) {\n    const baseCtor = vm.$options._base\n    // 用户传递的 components 不是 Vue.component的，是一个对象，不是 VueComponent 的实例\n    if (typeof Ctor === 'object') {\n        Ctor = baseCtor.extend(Ctor)\n    }\n    // 给组件增加生命周期\n    data.hook = {\n        init(vnode) {\n            let child = vnode.componentInstance = new Ctor({})\n            console.log('child', child)\n            child.$mount()\n        }\n    }\n    // 这里的 children 是插槽\n    return vnode(`vue-component-${Ctor.cid}-${tag}`, data, data.key, undefined, undefined, {Ctor, children})\n}\n\nfunction createTextVNode(text) {\n    return vnode(undefined, undefined, undefined, undefined, text)\n}\n\nfunction vnode(tag, data, key, children, text, componentOptions) {\n    return {\n        tag,\n        data,\n        key,\n        children,\n        text,\n        componentOptions, // 用来保存组件的构造函数和插槽\n    }\n}\n","import {mergeOptions} from \"../utils\";\n\nexport default function initExtend(Vue) {\n    let cid = 0\n    Vue.extend = function (extendOptions) {\n        const Super = this\n        const Sub = function VueComponent(options) {\n            this._init(options)\n        }\n        // 原型继承\n        Sub.prototype = Object.create(Super.prototype)\n        Sub.prototype.constructor = Sub\n        Sub.cid = cid++\n\n        // 处理其它属性 mixin component\n        Sub.options = mergeOptions(Super.options, extendOptions)\n\n        return Sub\n    }\n}\n","import {mergeOptions} from \"../utils\";\nimport initExtend from './extend'\n\nexport function initGlobalAPI(Vue) {\n    // 所有的属性都会合并到 Vue.options 上\n    Vue.options = {}\n    // initMixin()\n    Vue.mixin = function (mixin) {\n        this.options = mergeOptions(Vue.options, mixin)\n\n        console.log('this.options', this.options)\n    }\n\n    Vue.options._base = Vue\n    Vue.options.components = {}\n\n    initExtend(Vue)\n\n    // initAssetRegisters\n    Vue.component = function (id, definition) {\n        definition.name = definition.name || id // 组件名\n        // 永远是父类\n        definition = this.options._base.extend(definition)\n\n        // 注册组件\n        Vue.options.components[id] = definition\n    }\n\n    Vue.options.direction = {}\n    Vue.options.filter = {}\n}\n\n","import {initMixin} from './init'\nimport {lifecycleMixin} from './lifecycle'\nimport {renderMixin} from './vdom/index'\nimport {initGlobalAPI} from './global-api/index'\nimport {stateMixin} from './state'\n\nfunction Vue(options) {\n    this._init(options)\n}\n\n// 混入实例方法\ninitMixin(Vue)\nlifecycleMixin(Vue)\nrenderMixin(Vue)\nstateMixin(Vue)\n\n// 混入静态方法\ninitGlobalAPI(Vue)\n\n// import {compileToFunction} from \"./compiler/index\";\n// import {createElm, patch} from \"./vdom/patch\";\n//\n// let vm1 = new Vue({data: {name: 'zs'}})\n// let render1 = compileToFunction(`<div>\n// <li style=\"background:red\" key=\"A1\">A</li>\n// <li style=\"background:orange\" key=\"B5\">B</li>\n// <li style=\"background:yellow\" key=\"C\">C</li>\n// <li style=\"background:blue\" key=\"D1\">D</li>\n// </div>`)\n// let vnode1 = render1.call(vm1)\n//\n// document.body.appendChild(createElm(vnode1))\n// let vm2 = new Vue({data: {name: 'ls'}})\n// let render2 = compileToFunction(`<div>\n// <li style=\"background:green\" key=\"E1\">E</li>\n// <li style=\"background:purple\" key=\"A2\">A1</li>\n// <li style=\"background:orange\" key=\"B3\">B1</li>\n// <li style=\"background:yellow\" key=\"C\">C</li>\n// <li style=\"background:blue\" key=\"D2\">D</li>\n// </div>`)\n// let vnode2 = render2.call(vm2)\n//\n// setTimeout(() => {\n//     console.log('vnode1---------', vnode1)\n//     patch(vnode1, vnode2)\n// }, 2000)\n\nexport default Vue\n"],"names":["oldArrayProtoMethods","Array","prototype","arrayMethods","Object","create","methods","forEach","method","args","result","apply","ob","__ob__","inserted","slice","observeArray","dep","notify","proxy","vm","data","key","defineProperty","get","set","newValue","value","enumerable","configurable","strats","defaultStrat","parentVal","childVal","components","res","mergeHook","concat","LIFECYCLE_HOOKS","hook","mergeOptions","parent","child","options","mergeField","hasOwnProperty","strat","console","log","callbacks","pending","flushCallbacks","length","cb","pop","timerFunc","Promise","resolve","then","MutationObserver","observer","textNode","document","createTextNode","observe","characterData","textContent","setImmediate","setTimeout","nextTick","push","makeMap","str","mapping","split","map","item","isReservedTag","id","Dep","subs","target","addDep","watcher","sub","update","stack","pushTarget","popTarget","Observer","isArray","__proto__","walk","keys","defineReactive","childDep","depend","Watcher","exprOrFn","user","isWatcher","lazy","dirty","deps","depsId","Set","getter","path","obj","i","has","add","addSub","call","oldValue","queueWatcher","queue","flushSchedulerQueue","run","$nextTick","initState","opts","$options","props","initProps","initMethods","initData","computed","initComputed","watch","initWatch","_data","a","_computedWatchers","userDef","defineComputed","sharedPropertyDefinition","createComputedGetter","evaluate","handler","handle","createWatcher","$watch","stateMixin","Vue","attribute","ncname","qnameCapture","startTagOpen","RegExp","startTagClose","endTag","parseHTML","html","root","currentParent","start","tagName","attrs","element","createASTElement","end","children","chars","text","trim","type","tag","advance","n","substring","parseStartTag","match","name","textEnd","indexOf","startTagMatch","endTagMatch","defaultTagRE","genProps","attr","JSON","stringify","genChildren","el","gen","join","node","generate","test","tokens","index","lastIndex","exec","code","compileToFunction","template","ast","render","Function","patch","oldVnode","vnode","createElm","isRealElement","nodeType","parentEl","parentNode","insertBefore","nextSibling","removeChild","replaceChild","updateProperties","oldChildren","newChildren","updateChildren","innerHTML","appendChild","isSameVnode","newVnode","makeIndexByKey","oldStartIndex","oldEndIndex","oldStartVnode","oldEndVnode","newStartIndex","newStartVnode","newEndIndex","newEndVnode","moveIndex","undefined","moveVnode","ele","createComponent","init","componentInstance","$el","createElement","oldProps","newProps","removeAttribute","newStyle","style","oldStyle","styleName","className","setAttribute","lifecycleMixin","_update","prevVnode","_vnode","mountComponent","callHook","updateComponent","_render","hookName","handlers","initMixin","_init","constructor","$mount","querySelector","outerHTML","renderMixin","_c","_s","_v","createTextVNode","Ctor","baseCtor","_base","extend","cid","componentOptions","initExtend","extendOptions","Super","Sub","VueComponent","initGlobalAPI","mixin","component","definition","direction","filter"],"mappings":"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"}