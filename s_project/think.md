---
title: "前端工程化思想总结"
date: 2018-01-08 14:14:57
tags:
---

## 前端工程3个阶段

1. 库/框架的选型
2. 简单构建优化
3. JS/CSS模块化开发: 分治
js模块化：AMD/COMMON JS/UMD/ES6 MODULE
css模块化：less/sass/stylus

第4阶段
- 大体量: 多功能，多页面，多状态，多系统
- 大规模: 多人合作。
- 高性能: CDN部署、缓存控制、文件指纹、缓存复用、请求合并、按需加载、同步/异步加载、移动端首屏CSS内嵌、HTTP2.0服务端资源推送。
进入第四阶段，我们只需做好两件事就能大幅提升前端开发效率，并且兼顾运行性能，那就是——组件化开发与资源管理。

其实就是从开发到线上的问题：
开发：多人合作
选库
加速

组件化开发
- 根据页面可视区、可交互区域划分
- 每个组件一个目录，组件所需资源放一个目录,就近维护
- 组件之间自由组合
- 页面是组件的容器
- 组件可以直接替换或删除

js模块：浏览器环境检测(detect)、ajax、config、DOM操作、工具函数utils、组件里的js单元
css模块：栅格系统grid、字体图标icon-fonts、动画样式(animate)、以及组件里的CSS单元
UI组件：页头、页尾、搜索框
页面
应用

静态资源管理
前端代码和软件不同，是增量下载的。
增量原则引申出来的性能优化技巧：
- 加载相关：按需加载、延迟加载、预加载、请求合并
- 缓存：缓存利用、缓存更新、缓存共享、非覆盖式发布
- BigRender、BigPipe、Quicking、PageCache

静态资源管理系统 = 资源表 + 资源加载框架

资源表字段：key，类别，部署路径，依赖关系，打包合并
资源加载框架则提供一些资源引用的API，让开发者根据id来引用资源，替代静态的script/link标签来收集、去重、按需加载资源。

## 前端集成解决方案

Front-end Integrated Solution,缩写fis，发音[fɪs]

前端领域的技术元素
**技术与业务相关的开发需求**
1. 开发规范： 开发、部署的目录规范，编码规范。
2. 模块化开发：针对js、css以功能或业务为单元组织代码，js方面解决独立作用域、依赖管理、api暴露、按需加载与执行、安全合并等问题，css解决依赖管理、组件内部样式管理等问题。
3. 组件化开发
**技术沉淀与共享需求**
4. 组件仓库
**工程化需求**
5. 性能优化
6. 项目部署：静态资源缓存、cdn、非覆盖式发布。
7. 开发流程：开发调试、视觉效果走查确认、前后端联调、提测、上线。
8. 开发工具：工程工具，包括构建与优化工具、开发调试部署工具、组件库获取、提交，运营、文档、配置发布。

攒一套前端集成解决方案

所有技术点有一定联系：模块化开发涉及到性能优化、对构建工具有要求






## 性能优化原则

- `请求数量`: 合并脚本和css、css sprites、拆分初始化负载、划分主域。
- `请求带宽`: gzip、精简js、移除重复脚本、图像优化。
- `缓存利用`：cdn、外部js和css、expires头、减少dns查找、etag、使Ajax缓存。
- `页面结构`: css放顶部、js放底部、尽早刷新文档的输出。
- `代码校验`：避免css表达式、避免重定向。

### 请求数量

浏览器同一个服务器加载资源的并发量是有限制的，chrome大致是6个。所以可以对静态资源划分不同的主域，以加速资源的请求。

### 请求带宽

### 缓存利用

from disk cache
from memory cache

静态资源管理都是打包时根据文件hash生成新的文件名。使用query存在的问题是：覆盖式发布，浏览器缓存问题。

静态资源表和模块化加载方案的思路。
1. 生成资源表
2. 插入到合适的位置，js底部，css头部
3. 资源的合并combo，如a.html里a\b\c\d.js，b.html里a\b\e\f.js。在pkg里根据ab合并有个资源。

### 页面结构

md5的计算过程



### 代码校验


## 学习资源
https://developer.yahoo.com/performance/rules.html?guccounter=1
- [雅虎前端优化35条规则翻译](https://github.com/creeperyang/blog/issues/1)
- [fouber 前端工程与性能优化](https://github.com/fouber/blog/issues/3)
- https://medium.com/@arpingajjar/faster-web-page-loading-with-facebook-bigpipe-fbbc49b28959